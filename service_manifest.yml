name: ViperMonkey
version: 1
description: Office File VBA Macro Magnet.

accepts: (document/.*|code/xml|code/vbs)
rejects: empty|metadata/.*

stage: CORE
category: Static Analysis

file_required: true
timeout: 300
disable_cache: false

enabled: true
is_external: false
licence_count: 0

heuristics:
  - heur_id: 1
    name: ViperMonkey Error
    score: 1
    filetype: (document/.*|code/xml)
    description: ViperMonkey encountered an error

  - heur_id: 2
    name: Shell Function Found
    score: 100
    filetype: (document/.*|code/xml)
    description: Shell function found by ViperMonkey

  - heur_id: 3
    name: PowerShell Code Found
    score: 300
    filetype: (document/.*|code/xml)
    description: Discovered PowerShell code in file

  - heur_id: 4
    name: IOC Found
    score: 10
    filetype: (document/.*|code/xml)
    description: IOC found by ViperMonkey

  - heur_id: 5
    name: Possible Base64 Found
    score: 100
    filetype: (document/.*|code/xml)
    description: Found possible Base64 parameter

docker_config:
  image: ${REGISTRY}cccs/assemblyline-service-vipermonkey:latest
  cpu_cores: 1
  ram_mb: 768